---
import { cn } from '@/lib/utils';
import { cva, type VariantProps } from 'class-variance-authority';

const textVariants = cva('leading-none m-0', {
    variants: {
        variant: {
            // Hero variants
            'hero-title':
                'text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 leading-tight',
            'hero-subtitle':
                'text-xl md:text-2xl font-semibold text-gray-700 leading-relaxed',
            'hero-description':
                'text-lg md:text-xl text-gray-600 leading-relaxed',

            // Card variants
            'card-title': 'text-xl font-semibold text-gray-900',
            'card-subtitle': 'text-lg font-medium text-gray-700',
            'card-description': 'text-base text-gray-600 leading-relaxed',
            'card-content': 'text-sm text-gray-700 leading-normal',

            // Alert variants
            'alert-title': 'text-base font-medium leading-none tracking-tight',
            'alert-description': 'text-sm leading-relaxed',

            // Accordion variants
            'accordion-trigger':
                'text-base font-semibold text-gray-900 select-none',
            'accordion-content': 'text-sm text-gray-600 leading-relaxed',

            // Page variants
            'page-title': 'text-3xl font-bold text-gray-900',
            'page-subtitle': 'text-xl font-medium text-gray-700',

            // Section variants
            'section-title': 'text-2xl font-semibold text-gray-900',
            'section-subtitle': 'text-lg font-medium text-gray-700',

            // Feature variants
            'feature-title': 'text-xl font-semibold text-gray-900',
            'feature-description': 'text-base text-gray-600 leading-relaxed',

            // Testimonial variants
            'testimonial-quote': 'text-lg italic text-gray-700 leading-relaxed',
            'testimonial-author': 'text-sm font-medium text-gray-900',

            // Stats variants
            'stats-number': 'text-3xl md:text-4xl font-bold text-gray-900',
            'stats-label':
                'text-sm font-medium text-gray-600 uppercase tracking-wide',

            // Body variants
            body: 'text-base text-gray-900',
            'body-large': 'text-lg text-gray-900',
            'body-small': 'text-sm text-gray-700',

            // Utility variants
            caption: 'text-xs text-gray-500 uppercase tracking-wide',
            label: 'text-sm font-medium text-gray-700',
            overline:
                'text-xs font-medium text-gray-500 uppercase tracking-widest',

            // Interactive variants
            button: 'text-sm font-medium',
            link: 'text-sm text-blue-600 hover:text-blue-700 underline',

            // Status variants
            muted: 'text-sm text-gray-500',
            error: 'text-sm text-red-600 font-medium',
            success: 'text-sm text-green-600 font-medium',
            warning: 'text-sm text-yellow-600 font-medium',
            info: 'text-sm text-blue-600 font-medium',
        },
        state: {
            active: 'text-gray-900 font-medium',
            completed: 'text-gray-500 line-through',
            pending: 'text-gray-500 italic',
            disabled: 'text-gray-400 opacity-60',
        },
    },
    defaultVariants: {
        variant: 'body',
    },
});

export interface Props extends VariantProps<typeof textVariants> {
    class?: string;
    [key: string]: any; // Alpine.js pass-through
}

const { variant, state, class: className, ...rest } = Astro.props;

// Determine element based on variant if not explicitly set
const getElementFromVariant = (variant: string) => {
    switch (variant) {
        case 'hero-title':
        case 'page-title':
            return 'h1';
        case 'card-title':
        case 'section-title':
        case 'feature-title':
            return 'h2';
        case 'hero-subtitle':
        case 'card-subtitle':
        case 'page-subtitle':
        case 'section-subtitle':
            return 'h3';
        case 'alert-title':
            return 'h5';
        case 'hero-description':
        case 'card-description':
        case 'card-content':
        case 'accordion-content':
        case 'feature-description':
        case 'alert-description':
        case 'body':
        case 'body-large':
            return 'p';
        case 'testimonial-quote':
            return 'blockquote';
        case 'testimonial-author':
        case 'stats-label':
            return 'cite';
        case 'stats-number':
            return 'strong';
        case 'body-small':
        case 'caption':
        case 'muted':
            return 'small';
        case 'accordion-trigger':
        case 'label':
        case 'overline':
            return 'span';
        case 'button':
        case 'link':
            return 'span';
        default:
            return 'span';
    }
};

const Element = getElementFromVariant(variant || 'body');

const classes = cn(textVariants({ variant, state }), className);
---

<Element 
    class={classes} 
    x-bind:class={rest[':state'] ? `{
        'text-gray-900 font-medium': ${rest[':state']} === 'active',
        'text-gray-500 line-through': ${rest[':state']} === 'completed',
        'text-gray-500 italic': ${rest[':state']} === 'pending',
        'text-gray-400 opacity-60': ${rest[':state']} === 'disabled'
    }` : undefined}
    {...rest}
>
    <slot />
</Element>
