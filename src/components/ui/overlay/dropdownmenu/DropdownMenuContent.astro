---
import { cva, type VariantProps } from 'class-variance-authority';
import { cn } from '@/lib/utils';

const contentVariants = cva(
    'z-dropdown min-w-48 rounded-md border bg-popover text-popover-foreground shadow-md outline-none py-1',
    {
        variants: {
            size: {
                sm: 'min-w-32',
                md: 'min-w-48',
                lg: 'min-w-64',
                xl: 'min-w-80',
            },
            theme: {
                default: 'bg-popover border-border',
                dark: 'bg-gray-900 border-gray-700 text-white',
                minimal: 'bg-white border-gray-200 shadow-sm',
            },
        },
        defaultVariants: {
            size: 'md',
            theme: 'default',
        },
    }
);

export interface Props extends VariantProps<typeof contentVariants> {
    label?: string;
    className?: string;
    [key: string]: any;
}

const {
    label,
    size = 'md',
    theme = 'default',
    className,
    ...alpineProps
} = Astro.props;
---

<!-- Dropdown Menu Content -->
<template x-teleport="body">
    <div 
        x-show="dropdownOpen"
        x-ref="dropdownMenu"
        x-transition:enter="transition ease-out duration-100"
        x-transition:enter-start="transform opacity-0 scale-95"
        x-transition:enter-end="transform opacity-100 scale-100"
        x-transition:leave="transition ease-in duration-75"
        x-transition:leave-start="transform opacity-100 scale-100"
        x-transition:leave-end="transform opacity-0 scale-95"
        :style="`position: fixed; left: ${dropdownPosition.x}px; top: ${dropdownPosition.y}px; z-index: 9999;`"
        class={cn(contentVariants({ size, theme }), className)}
        role="menu"
        tabindex="-1"
        @click="handleMenuItemClick($event)"
        {...alpineProps}
    >
        <!-- Optional Label -->
        {label && (
            <div class="px-3 py-1.5 text-xs font-semibold text-muted-foreground border-b border-border mb-1">
                {label}
            </div>
        )}
        
        <!-- Menu Content -->
        <div>
            <slot />
        </div>
    </div>
</template>