---
import { cn } from '@/lib/utils';
import { createUIComponent, type UIComponentProps, type VariantProps } from '@/lib/component-variants';

const quotesVariants = createUIComponent(
  '',
  {
    variant: {
      default: 'text-left',
      centered: 'text-center',
      minimal: 'text-left border-l-4 border-neutral-200 pl-6'
    },
    quoteSize: {
      sm: '[&_.quote-text]:text-base [&_.author-text]:text-sm',
      md: '[&_.quote-text]:text-lg [&_.author-text]:text-base',
      lg: '[&_.quote-text]:text-xl [&_.author-text]:text-lg'
    }
  }
);

export interface Props extends UIComponentProps, VariantProps<typeof quotesVariants> {
  quote: string;
  author: string;
  role?: string;
  company?: string;
  avatar?: string;
}

const { 
  quote,
  author,
  role,
  company,
  avatar,
  variant = 'default',
  quoteSize = 'md',
  padding = 'none',
  margin = 'none',
  elevation = 'none',
  overflow = 'fixed',
  size,
  class: className,
  ...alpineProps
} = Astro.props;
---

<!-- 
Pine UI Quotes Component

Usage:
<Quotes 
  quote="This is an amazing product that has transformed our workflow."
  author="John Doe"
  role="CEO"
  company="Acme Corp"
  avatar="/path/to/avatar.jpg"
  variant="centered"
  size="lg"
/>

Props:
- quote: The quote text (required)
- author: Author name (required)
- role: Author's job title (optional)
- company: Author's company (optional)
- avatar: URL to author's avatar image (optional)
- variant: Layout style - 'default', 'centered', 'minimal'
- size: Text size - 'sm', 'md', 'lg'
- class: Additional CSS classes
-->

<blockquote 
  class={cn(
    quotesVariants({ variant, quoteSize, padding, margin, elevation, overflow, size }),
    className
  )}
  {...alpineProps}
>
  {variant !== 'minimal' && (
    <svg class={`${variant === 'centered' ? 'mx-auto' : ''} mb-4 w-8 h-8 text-neutral-400`} fill="currentColor" viewBox="0 0 20 20">
      <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
    </svg>
  )}
  
  <p class={`quote-text text-neutral-700 font-medium italic ${variant === 'minimal' ? 'mb-2' : 'mb-6'}`}>
    "{quote}"
  </p>
  
  <footer class={`${variant === 'centered' ? 'flex flex-col items-center' : 'flex items-center'} gap-3`}>
    {avatar && (
      <img 
        class="w-12 h-12 rounded-full object-cover"
        src={avatar}
        alt={`${author} avatar`}
        loading="lazy"
      />
    )}
    
    <div class={variant === 'centered' ? 'text-center' : ''}>
      <cite class="author-text not-italic font-semibold text-neutral-900">
        {author}
      </cite>
      {(role || company) && (
        <p class="text-sm text-neutral-500 mt-1">
          {role && role}{role && company && ', '}{company && company}
        </p>
      )}
    </div>
  </footer>
</blockquote>