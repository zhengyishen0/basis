---
import Layout from '@/layouts/Layout.astro';
import {
    ContextMenu,
    ContextMenuTrigger,
    ContextMenuContent,
    ContextMenuItem,
    ContextMenuGroup,
    ContextMenuSubmenu,
    ContextMenuSubTrigger,
} from '@/components/ui/overlay/contextmenu';
import { Divider } from '@/components/ui/layout';
---

<Layout title="Context Menu Demo">
    <main class="container mx-auto p-8 space-y-12">
        <div class="text-center">
            <h1 class="text-3xl font-bold mb-4">Context Menu Component Demo</h1>
            <p class="text-muted-foreground mb-8">
                Composable context menu components with keyboard navigation,
                submenus, and smart positioning
            </p>
        </div>

        <!-- Dynamic x-for Example -->
        <section class="space-y-6">
            <h2 class="text-2xl font-semibold">Dynamic x-for Support</h2>

            <div
                x-data="{
                    menuGroups: [
                        {
                            heading: 'File Actions',
                            items: [
                                { text: 'New File', shortcut: 'Ctrl+N' },
                                { text: 'Open File', shortcut: 'Ctrl+O' },
                                { text: 'Save File', shortcut: 'Ctrl+S' }
                            ]
                        },
                        {
                            heading: 'Edit Actions', 
                            items: [
                                { text: 'Cut', shortcut: 'Ctrl+X' },
                                { text: 'Copy', shortcut: 'Ctrl+C' },
                                { text: 'Paste', shortcut: 'Ctrl+V' },
                                { 
                                    text: 'Share', 
                                    submenu: [
                                        { text: 'Email' },
                                        { text: 'Copy Link' },
                                        { text: 'Social Media' }
                                    ]
                                },
                                { 
                                    text: 'Export', 
                                    submenu: [
                                        { text: 'PDF' },
                                        { text: 'Excel' },
                                        { text: 'Image' }
                                    ]
                                }
                            ]
                        },
                        {
                            heading: 'Danger Zone',
                            items: [
                                { text: 'Delete', variant: 'destructive' }
                            ]
                        }
                    ]
                }"
                class="text-center"
            >
                <ContextMenu trigger="rightclick">
                    <ContextMenuTrigger>
                        <div
                            class="w-64 h-40 bg-gradient-to-br from-cyan-50 to-blue-100 border rounded-lg flex items-center justify-center mx-auto"
                        >
                            <span class="text-center">
                                Right-click for dynamic menu
                            </span>
                        </div>
                    </ContextMenuTrigger>
                    <ContextMenuContent>
                        <template x-for="group in menuGroups" x-key="group.heading">
                            <div>
                                <!-- Regular items -->
                                <template x-if="group.items">
                                    <div>
                                        <ContextMenuGroup x-for="group in [group]" x-key="group.heading" />
                                        <template x-for="item in group.items" x-key="item.text">
                                            <div>
                                                <!-- Regular menu item -->
                                                <template x-if="!item.submenu">
                                                    <ContextMenuItem x-for="item in [item]" x-key="item.text">
                                                        <span x-text="item.text"></span>
                                                    </ContextMenuItem>
                                                </template>
                                                
                                                <!-- Submenu item -->
                                                <template x-if="item.submenu">
                                                    <ContextMenuSubmenu>
                                                        <ContextMenuSubTrigger>
                                                            <span x-text="item.text"></span>
                                                        </ContextMenuSubTrigger>
                                                        <div slot="submenu">
                                                            <ContextMenuItem x-for="subitem in item.submenu" x-key="subitem.text">
                                                                <span x-text="subitem.text"></span>
                                                            </ContextMenuItem>
                                                        </div>
                                                    </ContextMenuSubmenu>
                                                </template>
                                            </div>
                                        </template>
                                    </div>
                                </template>
                                
                                <Divider x-show="group !== menuGroups[menuGroups.length - 1]" />
                            </div>
                        </template>
                    </ContextMenuContent>
                </ContextMenu>
            </div>
        </section>
    </main>
</Layout>
