---
import Layout from '../../layouts/Layout.astro';
import Card from '../../components/pine/Card.astro';
import Button from '../../components/pine/Button.astro';
import Badge from '../../components/pine/Badge.astro';
import Textarea from '../../components/pine/Textarea.astro';
---

<Layout title="Textarea Component Test">
  <main class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold mb-4">Textarea Component Test</h1>
      <div class="flex justify-center gap-2 mb-6">
        <Button href="/test" variant="outline" color="neutral">← Back to Test Suite</Button>
        <Button href="/test/all" variant="ghost" color="neutral">View All</Button>
      </div>
    </div>

    <!-- Style Variants Test -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Style Variants</h2>
        <div class="space-y-6">
          <div>
            <h3 class="text-lg font-semibold mb-3">Default Variant</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                variant="default"
                label="Default Textarea"
                placeholder="Enter your message here..."
                description="Standard textarea with border"
                id="default-1"
                rows={4}
              />
              
              <Textarea 
                variant="default"
                label="Default with Value"
                value="This is a pre-filled textarea with the default styling that includes a standard border and background."
                description="Default style with initial content"
                id="default-2"
                rows={4}
              />
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-3">Filled Variant</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                variant="filled"
                label="Filled Textarea"
                placeholder="Enter your thoughts..."
                description="Filled background style"
                id="filled-1"
                rows={4}
              />
              
              <Textarea 
                variant="filled"
                label="Filled with Value"
                value="This textarea uses the filled variant with a gray background that changes to white when focused."
                description="Filled style with initial content"
                id="filled-2"
                rows={4}
              />
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-3">Underlined Variant</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                variant="underlined"
                label="Underlined Textarea"
                placeholder="Minimal design..."
                description="Clean underlined style"
                id="underlined-1"
                rows={4}
              />
              
              <Textarea 
                variant="underlined"
                label="Underlined with Value"
                value="This textarea features the minimal underlined variant with only a bottom border."
                description="Underlined style with initial content"
                id="underlined-2"
                rows={4}
              />
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Rows and Auto-resize Test -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Rows and Auto-resize</h2>
        <div class="space-y-6">
          <div>
            <h3 class="text-lg font-semibold mb-3">Fixed Row Heights</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <Textarea 
                label="Small (2 rows)"
                placeholder="Small textarea..."
                rows={2}
                id="rows-2"
              />
              
              <Textarea 
                label="Medium (4 rows)"
                placeholder="Medium textarea..."
                rows={4}
                id="rows-4"
              />
              
              <Textarea 
                label="Large (6 rows)"
                placeholder="Large textarea..."
                rows={6}
                id="rows-6"
              />
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-3">Auto-resize Textareas</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                label="Auto-resize Textarea"
                placeholder="Start typing and watch me grow..."
                description="This textarea will automatically resize as you type"
                autoResize={true}
                rows={3}
                id="auto-resize-1"
              />
              
              <Textarea 
                label="Auto-resize with Value"
                value="This textarea starts with some content and will automatically adjust its height as you add or remove text. Try editing this content to see it in action!"
                description="Auto-resize with initial content"
                autoResize={true}
                rows={3}
                id="auto-resize-2"
              />
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Character Count and Validation -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Character Count and Validation</h2>
        <div class="space-y-6">
          <div>
            <h3 class="text-lg font-semibold mb-3">Character Limits</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                label="Tweet-style (280 chars)"
                placeholder="What's happening?"
                maxLength={280}
                showCount={true}
                description="Perfect for short messages"
                id="char-limit-short"
                rows={3}
              />
              
              <Textarea 
                label="Comment (500 chars)"
                placeholder="Share your thoughts..."
                maxLength={500}
                showCount={true}
                description="Good for comments and feedback"
                id="char-limit-medium"
                rows={4}
              />
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-3">Auto-resize with Character Count</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                label="Auto-resize + Count"
                placeholder="Type and watch it grow..."
                autoResize={true}
                maxLength={1000}
                showCount={true}
                description="Combines auto-resize with character counting"
                id="auto-count-1"
                rows={3}
              />
              
              <Textarea 
                label="Long Form Content"
                placeholder="Write a detailed description..."
                autoResize={true}
                maxLength={2000}
                showCount={true}
                description="For longer content like descriptions"
                value="This is a longer textarea that combines auto-resize functionality with character counting. It's perfect for forms where users need to write detailed content like product descriptions, blog posts, or comprehensive feedback."
                id="auto-count-2"
                rows={4}
              />
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- States Test -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Input States</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h3 class="text-lg font-semibold mb-4">Standard States</h3>
            <div class="space-y-4">
              <Textarea 
                label="Normal State"
                placeholder="Normal textarea"
                description="Standard textarea state"
                id="state-normal"
                rows={3}
              />
              
              <Textarea 
                label="Required Field"
                placeholder="This field is required"
                description="Field marked as required"
                required={true}
                id="state-required"
                rows={3}
              />
              
              <Textarea 
                label="Disabled Textarea"
                placeholder="Cannot be edited"
                description="Textarea is disabled"
                disabled={true}
                value="This content cannot be edited because the textarea is disabled."
                id="state-disabled"
                rows={3}
              />
              
              <Textarea 
                label="Read-only Textarea"
                description="Textarea is read-only"
                readonly={true}
                value="This content is read-only and cannot be modified by the user."
                id="state-readonly"
                rows={3}
              />
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-4">Error States</h3>
            <div class="space-y-4">
              <Textarea 
                label="Content Too Short"
                placeholder="Enter at least 10 characters..."
                error="Content must be at least 10 characters long"
                value="Short"
                id="error-short"
                rows={3}
              />
              
              <Textarea 
                label="Content Too Long"
                placeholder="Keep it under 100 characters..."
                error="Content exceeds maximum length of 100 characters"
                value="This content is way too long for the specified limit and should trigger an error message to inform the user about the validation issue."
                maxLength={100}
                showCount={true}
                id="error-long"
                rows={3}
              />
              
              <Textarea 
                label="Required Field Error"
                placeholder="This field is required"
                error="This field cannot be empty"
                required={true}
                id="error-required"
                rows={3}
              />
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Interactive Form Example -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Interactive Form Example</h2>
        <form x-data="{ 
          formData: {
            subject: '',
            message: '',
            feedback: '',
            description: ''
          },
          
          errors: {},
          
          validateField(field, value) {
            this.errors[field] = '';
            
            switch(field) {
              case 'subject':
                if (!value.trim()) {
                  this.errors[field] = 'Subject is required';
                } else if (value.length < 5) {
                  this.errors[field] = 'Subject must be at least 5 characters';
                }
                break;
              case 'message':
                if (!value.trim()) {
                  this.errors[field] = 'Message is required';
                } else if (value.length < 20) {
                  this.errors[field] = 'Message must be at least 20 characters';
                }
                break;
              case 'feedback':
                if (value && value.length > 500) {
                  this.errors[field] = 'Feedback cannot exceed 500 characters';
                }
                break;
            }
          },
          
          submitForm() {
            // Validate all fields
            Object.keys(this.formData).forEach(field => {
              this.validateField(field, this.formData[field]);
            });
            
            const hasErrors = Object.values(this.errors).some(error => error);
            
            if (!hasErrors) {
              alert('Form submitted successfully!\\n\\n' + JSON.stringify(this.formData, null, 2));
            } else {
              alert('Please fix the errors in the form before submitting.');
            }
          }
        }" @submit.prevent="submitForm()">
          <div class="space-y-6">
            <h3 class="text-lg font-semibold">Contact Form</h3>
            
            <!-- Subject -->
            <div>
              <Textarea 
                label="Subject"
                placeholder="Enter the subject of your message..."
                required={true}
                x-model="formData.subject"
                @input="validateField('subject', $event.target.value)"
                :error="errors.subject"
                rows={2}
                maxLength={100}
                showCount={true}
                id="form-subject"
              />
            </div>
            
            <!-- Message -->
            <div>
              <Textarea 
                label="Message"
                placeholder="Enter your detailed message here..."
                description="Please provide as much detail as possible"
                required={true}
                x-model="formData.message"
                @input="validateField('message', $event.target.value)"
                :error="errors.message"
                autoResize={true}
                rows={4}
                maxLength={1000}
                showCount={true}
                id="form-message"
              />
            </div>
            
            <!-- Feedback -->
            <div>
              <Textarea 
                label="Additional Feedback"
                placeholder="Any additional comments or suggestions..."
                description="Optional: Share any other thoughts or suggestions"
                x-model="formData.feedback"
                @input="validateField('feedback', $event.target.value)"
                :error="errors.feedback"
                variant="filled"
                rows={3}
                maxLength={500}
                showCount={true}
                id="form-feedback"
              />
            </div>
            
            <!-- Description -->
            <div>
              <Textarea 
                label="Technical Details"
                placeholder="If reporting an issue, please describe the technical details..."
                description="Include browser, OS, steps to reproduce, etc."
                x-model="formData.description"
                variant="underlined"
                autoResize={true}
                rows={3}
                id="form-description"
              />
            </div>
            
            <!-- Form Actions -->
            <div class="flex gap-4 pt-6 border-t">
              <Button type="submit" variant="solid" color="blue">
                Submit Form
              </Button>
              <Button type="button" variant="outline" color="neutral" @click="formData = {}; errors = {};">
                Clear Form
              </Button>
            </div>
            
            <!-- Form Data Preview -->
            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
              <h4 class="font-semibold mb-2">Form Data Preview:</h4>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div>
                  <strong>Subject:</strong> <span x-text="formData.subject || 'Empty'"></span>
                  <br />
                  <strong>Characters:</strong> <span x-text="formData.subject ? formData.subject.length : 0"></span>
                </div>
                <div>
                  <strong>Message:</strong> <span x-text="formData.message ? formData.message.substring(0, 50) + '...' : 'Empty'"></span>
                  <br />
                  <strong>Characters:</strong> <span x-text="formData.message ? formData.message.length : 0"></span>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </Card>

    <!-- Custom Styling Examples -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Custom Styling Examples</h2>
        <div class="space-y-6">
          <!-- Custom Textarea Classes -->
          <div>
            <h3 class="text-lg font-semibold mb-3">Custom Textarea Styling</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                label="Rounded Textarea"
                placeholder="Custom rounded corners..."
                textareaClass="rounded-xl border-2 border-purple-300 focus:border-purple-500"
                description="Custom border and rounded corners"
                id="custom-rounded"
                rows={3}
              />
              
              <Textarea 
                label="Colored Background"
                placeholder="Custom background color..."
                textareaClass="bg-blue-50 border-blue-300 focus:bg-white focus:border-blue-500"
                description="Custom background and border colors"
                id="custom-bg"
                rows={3}
              />
            </div>
          </div>
          
          <!-- Custom Container Styling -->
          <div>
            <h3 class="text-lg font-semibold mb-3">Custom Container Styling</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Textarea 
                label="Highlighted Container"
                placeholder="Container with highlight..."
                class="bg-yellow-50 p-4 rounded-lg border border-yellow-200"
                description="Custom container background"
                id="custom-container-1"
                rows={3}
              />
              
              <Textarea 
                label="Card-style Container"
                placeholder="Card-like appearance..."
                class="bg-white p-4 rounded-lg shadow-md border border-gray-200"
                description="Card-style container with shadow"
                id="custom-container-2"
                rows={3}
              />
            </div>
          </div>
        </div>
      </div>
    </Card>

    <!-- Status Summary -->
    <Card>
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Test Results</h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">✓ Working</Badge>
            <p class="text-sm">All variants working</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">✓ Working</Badge>
            <p class="text-sm">Auto-resize functionality</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">✓ Working</Badge>
            <p class="text-sm">Character counting</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">✓ Working</Badge>
            <p class="text-sm">Error handling</p>
          </div>
        </div>
      </div>
    </Card>
  </main>
</Layout>