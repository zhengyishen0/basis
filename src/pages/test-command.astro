---
import Layout from '@/layouts/Layout.astro';
---

<Layout title="Command Test">
  <div class="container mx-auto p-8">
    <h1 class="text-3xl font-bold mb-8">Command Component Test</h1>
    
    <div 
      x-data="{
        commandItems: {
          suggestions: [
            { title: 'Calendar', value: 'calendar', default: true },
            { title: 'Search', value: 'search', default: true }
          ]
        },
        commandSearch: '',
        get filteredItems() {
          if (!this.commandSearch.trim()) {
            return Object.entries(this.commandItems).reduce((acc, [category, items]) => {
              const defaultItems = items.filter(item => item.default);
              if (defaultItems.length > 0) {
                acc[category] = defaultItems;
              }
              return acc;
            }, {});
          }
          
          const search = this.commandSearch.toLowerCase();
          return Object.entries(this.commandItems).reduce((acc, [category, items]) => {
            const filtered = items.filter(item => 
              item.title.toLowerCase().includes(search)
            );
            if (filtered.length > 0) {
              acc[category] = filtered;
            }
            return acc;
          }, {});
        },
        get hasResults() {
          return Object.keys(this.filteredItems).length > 0;
        }
      }"
      class="max-w-md mx-auto border rounded-lg p-4"
    >
      <input 
        x-model="commandSearch" 
        placeholder="Type to search..." 
        class="w-full p-2 border rounded mb-4"
      />
      
      <div x-show="hasResults">
        <template x-for="[categoryName, categoryItems] in Object.entries(filteredItems)" :key="categoryName">
          <div class="mb-4">
            <h3 x-text="categoryName" class="font-bold mb-2"></h3>
            <template x-for="item in categoryItems" :key="item.value">
              <div x-text="item.title" class="p-2 hover:bg-gray-100 cursor-pointer" x-on:click="alert('Selected: ' + item.title)"></div>
            </template>
          </div>
        </template>
      </div>
      
      <div x-show="!hasResults" class="text-gray-500 text-center py-4">
        No results found
      </div>
    </div>
  </div>
</Layout>