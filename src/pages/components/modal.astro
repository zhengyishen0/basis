---
import Layout from '../../layouts/Layout.astro';
import Card from '../../components/pine/Card.astro';
import Button from '../../components/pine/Button.astro';
import Modal from '../../components/pine/Modal.astro';
import Badge from '../../components/pine/Badge.astro';
---

<Layout title="Modal Component Test">
  <main class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold mb-4">Modal Component Test</h1>
      <div class="flex justify-center gap-2 mb-6">
        <Button href="/test" variant="outline" color="neutral">← Back to Test Suite</Button>
        <Button href="/test/all" variant="ghost" color="neutral">View All</Button>
      </div>
    </div>

    <!-- Basic Modal Test -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Basic Modal</h2>
        <Modal id="basic-modal" size="md">
          <div slot="trigger">
            <Button variant="solid" color="blue">Open Basic Modal</Button>
          </div>
          
          <div slot="header">
            <h3 class="text-lg font-semibold">Basic Modal Title</h3>
          </div>
          
          <div slot="body">
            <p class="text-gray-600">This is a basic modal with default settings. You can close it by clicking the X button, pressing Escape, or clicking outside the modal.</p>
          </div>
          
          <div slot="footer">
            <Button variant="outline" color="neutral" x-on:click="modalOpen = false">Cancel</Button>
            <Button variant="solid" color="blue" x-on:click="modalOpen = false">Confirm</Button>
          </div>
        </Modal>
      </div>
    </Card>

    <!-- Size Variants -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Size Variants</h2>
        <div class="flex flex-wrap gap-4">
          <Modal id="small-modal" size="sm">
            <div slot="trigger">
              <Button variant="solid" color="purple" size="sm">Small Modal</Button>
            </div>
            <div slot="header">
              <h3 class="text-lg font-semibold">Small Modal</h3>
            </div>
            <div slot="body">
              <p>This is a small modal (max-w-sm).</p>
            </div>
            <div slot="footer">
              <Button variant="solid" color="purple" size="sm" x-on:click="modalOpen = false">Close</Button>
            </div>
          </Modal>

          <Modal id="medium-modal" size="md">
            <div slot="trigger">
              <Button variant="solid" color="blue">Medium Modal</Button>
            </div>
            <div slot="header">
              <h3 class="text-lg font-semibold">Medium Modal</h3>
            </div>
            <div slot="body">
              <p>This is a medium modal (max-w-md) - the default size.</p>
            </div>
            <div slot="footer">
              <Button variant="solid" color="blue" x-on:click="modalOpen = false">Close</Button>
            </div>
          </Modal>

          <Modal id="large-modal" size="lg">
            <div slot="trigger">
              <Button variant="solid" color="green">Large Modal</Button>
            </div>
            <div slot="header">
              <h3 class="text-lg font-semibold">Large Modal</h3>
            </div>
            <div slot="body">
              <p>This is a large modal (max-w-lg) with more content space.</p>
            </div>
            <div slot="footer">
              <Button variant="solid" color="green" x-on:click="modalOpen = false">Close</Button>
            </div>
          </Modal>

          <Modal id="xl-modal" size="xl">
            <div slot="trigger">
              <Button variant="solid" color="red">Extra Large</Button>
            </div>
            <div slot="header">
              <h3 class="text-lg font-semibold">Extra Large Modal</h3>
            </div>
            <div slot="body">
              <p>This is an extra large modal (max-w-xl) for content that needs more space.</p>
            </div>
            <div slot="footer">
              <Button variant="solid" color="red" x-on:click="modalOpen = false">Close</Button>
            </div>
          </Modal>
        </div>
      </div>
    </Card>

    <!-- Non-closeable Modal -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Non-closeable Modal</h2>
        <Modal id="non-closeable-modal" size="md" closeable={false}>
          <div slot="trigger">
            <Button variant="outline" color="yellow">Open Non-closeable Modal</Button>
          </div>
          
          <div slot="header">
            <h3 class="text-lg font-semibold">Non-closeable Modal</h3>
          </div>
          
          <div slot="body">
            <p class="text-gray-600">This modal cannot be closed by clicking outside or pressing Escape. You must use the buttons in the footer.</p>
          </div>
          
          <div slot="footer">
            <Button variant="outline" color="red" x-on:click="modalOpen = false">Cancel</Button>
            <Button variant="solid" color="green" x-on:click="modalOpen = false">Force Close</Button>
          </div>
        </Modal>
      </div>
    </Card>

    <!-- Form Modal -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Form Modal</h2>
        <Modal id="form-modal" size="lg">
          <div slot="trigger">
            <Button variant="solid" color="green">Open Form Modal</Button>
          </div>
          
          <div slot="header">
            <h3 class="text-lg font-semibold">Create New Item</h3>
          </div>
          
          <div slot="body">
            <form class="space-y-4" x-data="{ name: '', email: '', message: '' }">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Name</label>
                <input 
                  type="text" 
                  x-model="name"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="Enter your name"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                <input 
                  type="email" 
                  x-model="email"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="Enter your email"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Message</label>
                <textarea 
                  x-model="message"
                  rows="3"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder="Enter your message"
                ></textarea>
              </div>
            </form>
          </div>
          
          <div slot="footer">
            <Button variant="outline" color="neutral" x-on:click="modalOpen = false">Cancel</Button>
            <Button variant="solid" color="green" x-on:click="modalOpen = false">Submit</Button>
          </div>
        </Modal>
      </div>
    </Card>

    <!-- Interactive Modal with Alpine.js -->
    <Card class="mb-8">
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Interactive Modal</h2>
        <div x-data="{ counter: 0, items: [] }">
          <Modal id="interactive-modal" size="lg">
            <div slot="trigger">
              <Button variant="solid" color="purple">Open Interactive Modal</Button>
            </div>
            
            <div slot="header">
              <h3 class="text-lg font-semibold">Interactive Counter & List</h3>
            </div>
            
            <div slot="body">
              <div class="space-y-6">
                <!-- Counter -->
                <div class="p-4 bg-gray-50 rounded-lg">
                  <h4 class="font-semibold mb-3">Counter: <span x-text="counter" class="text-purple-600"></span></h4>
                  <div class="flex gap-2">
                    <Button variant="solid" color="green" size="sm" x-on:click="counter++">+</Button>
                    <Button variant="outline" color="red" size="sm" x-on:click="counter--">-</Button>
                    <Button variant="soft" color="neutral" size="sm" x-on:click="counter = 0">Reset</Button>
                  </div>
                </div>

                <!-- Dynamic List -->
                <div class="p-4 bg-gray-50 rounded-lg">
                  <h4 class="font-semibold mb-3">Dynamic List</h4>
                  <div class="flex gap-2 mb-3">
                    <Button 
                      variant="solid" 
                      color="blue" 
                      size="sm" 
                      x-on:click="items.push(`Item ${items.length + 1}`)"
                    >
                      Add Item
                    </Button>
                    <Button 
                      variant="outline" 
                      color="red" 
                      size="sm" 
                      x-on:click="items = []"
                    >
                      Clear All
                    </Button>
                  </div>
                  <ul class="space-y-1">
                    <template x-for="(item, index) in items" :key="index">
                      <li class="flex justify-between items-center p-2 bg-white rounded">
                        <span x-text="item"></span>
                        <button 
                          x-on:click="items.splice(index, 1)"
                          class="text-red-500 hover:text-red-700 text-sm"
                        >
                          Remove
                        </button>
                      </li>
                    </template>
                  </ul>
                  <p x-show="items.length === 0" class="text-gray-500 text-sm mt-2">No items yet. Click "Add Item" to start.</p>
                </div>
              </div>
            </div>
            
            <div slot="footer">
              <Button variant="outline" color="neutral" x-on:click="modalOpen = false">Close</Button>
              <Button variant="solid" color="purple" x-on:click="alert('Data saved!'); modalOpen = false">Save</Button>
            </div>
          </Modal>
        </div>
      </div>
    </Card>

    <!-- Status Summary -->
    <Card>
      <div class="p-6">
        <h2 class="text-2xl font-bold mb-4">Test Results</h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">✓ Working</Badge>
            <p class="text-sm">Basic functionality</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">✓ Working</Badge>
            <p class="text-sm">Size variants</p>
          </div>
          <div class="text-center p-4 bg-green-50 rounded-lg">
            <Badge color="green" class="mb-2">✓ Working</Badge>
            <p class="text-sm">Alpine.js integration</p>
          </div>
          <div class="text-center p-4 bg-blue-50 rounded-lg">
            <Badge color="blue" class="mb-2">? Testing</Badge>
            <p class="text-sm">x-teleport feature</p>
          </div>
        </div>
      </div>
    </Card>
  </main>
</Layout>